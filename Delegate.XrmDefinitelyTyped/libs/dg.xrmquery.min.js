var Filter;
(function(c){c.equals=function(a,b){return XQC.Comp(a,"eq",b)};c.notEquals=function(a,b){return XQC.Comp(a,"ne",b)};c.greaterThan=function(a,b){return XQC.Comp(a,"gt",b)};c.greaterThanOrEqual=function(a,b){return XQC.Comp(a,"ge",b)};c.lessThan=function(a,b){return XQC.Comp(a,"lt",b)};c.lessThanOrEqual=function(a,b){return XQC.Comp(a,"le",b)};c.and=function(a,b){return XQC.BiFilter(a,"and",b)};c.or=function(a,b){return XQC.BiFilter(a,"or",b)};c.not=function(a){return"not "+a};c.ands=function(a){return XQC.NestedFilter(a,"and")};
c.ors=function(a){return XQC.NestedFilter(a,"or")};c.startsWith=function(a,b){return XQC.DataFunc("startswith",a,b)};c.substringOf=function(a,b){return XQC.DataFunc("substringof",a,b)};c.endsWith=function(a,b){return XQC.DataFunc("endswith",a,b)};c.makeGuid=function(a){return XQC.makeTag("(guid'"+a+"')")}})(Filter||(Filter={}));var XrmQuery;
(function(c){c.retrieveRecord=function(a,b){return new XQC.RetrieveRecord(a,b)};c.retrieveMultipleRecords=function(a){return new XQC.RetrieveMultipleRecords(a)};c.createRecord=function(a,b){return new XQC.CreateRecord(a,b)};c.updateRecord=function(a,b,c){return new XQC.UpdateRecord(a,b,c)};c.deleteRecord=function(a,b){return new XQC.DeleteRecord(a,b)}})(XrmQuery||(XrmQuery={}));var XQC;
(function(c){function a(f){return null==f?"null":"string"===typeof f?"'"+f+"'":"[object Date]"===Object.prototype.toString.call(f)?"DateTime'"+f.format("yyyy-MM-ddTHH:mm:ss")+"'":f.toString()}function b(f){var d,e;e=f.toString().match(l);if(!e)throw Error("XrmQuery: Unable to properly parse function: "+f.toString());d=e[1];e=e[2];d=new RegExp("\\b"+d+"\\.([a-zA-Z_$][0-9a-zA-Z_$]*)(\\.([a-zA-Z_$][0-9a-zA-Z_$]*))?","g");for(var b={},a;null!=(a=d.exec(e));)b[a[1]]||(b[a[1]]=k(a[1])),a[3]&&(b[a[1]][a[3]]=
k(a[1]+"/"+a[3]));return f(b)}function k(a){return{__str:a,toString:function(){return this.__str}}}c.Comp=function(b,d,e){return a(b)+" "+d+" "+a(e)};c.DataFunc=function(b,d,e){return b+"("+a(d)+", "+a(e)+")"};c.BiFilter=function(a,d,b){return"("+a+" "+d+" "+b+")"};c.NestedFilter=function(a,d){var b=a.pop();return a.reduceRight(function(a,b){return c.BiFilter(b,d,a)},b)};var l=/function[^\(]*\(([a-zA-Z0-9_]+)[^\{]*\{([\s\S]*)\}$/m;c.makeTag=k;var g=function(){},h=function(){function a(d,e){this.selects=
[];this.expands=[];this.logicalName=b(d).toString();this.id=e}a.prototype.select=function(d){this.selects=this.selects.concat(b(d));return this};a.prototype.expand=function(d,a){var c=b(d).toString();this.expands.push(c);a&&(this.selects=this.selects.concat(b(a).map(function(a){return c+"."+a})));return this};a.prototype.execute=function(a,b){SDK.REST.retrieveRecord(this.id,this.logicalName,0<this.selects.length?this.selects.join(","):null,0<this.expands.length?this.expands.join(","):null,a,b?b:g)};
return a}();c.RetrieveRecord=h;h=function(){function a(d){this.selects=[];this.expands=[];this.ordering=[];this.topAmount=this.skipAmount=null;this.logicalName=b(d).toString()}a.prototype.select=function(a){this.selects=this.selects.concat(b(a));return this};a.prototype.expand=function(a,c){var f=b(a).toString();this.expands.push(f);c&&(this.selects=this.selects.concat(b(c).map(function(a){return f+"/"+a})));return this};a.prototype.filter=function(a){this.filters=b(a);return this};a.prototype.orFilter=
function(a){this.filters?this.filters=Filter.or(this.filters,b(a)):this.filter(a);return this};a.prototype.andFilter=function(a){this.filters?this.filters=Filter.and(this.filters,b(a)):this.filter(a);return this};a.prototype.order=function(a,c){this.ordering.push(b(a)+" "+c);return this};a.prototype.orderAsc=function(a){return this.order(a,"asc")};a.prototype.orderDesc=function(a){return this.order(a,"desc")};a.prototype.skip=function(a){this.skipAmount=a;return this};a.prototype.top=function(a){this.topAmount=
a;return this};a.prototype.execute=function(a,b,c){SDK.REST.retrieveMultipleRecords(this.logicalName,this.getOptionString(),a,b?b:g,c?c:g)};a.prototype.getFirst=function(a,b){this.top(1);this.execute(function(b){return a(0<b.length?b[0]:null)},b,g)};a.prototype.getOptionString=function(){var a=[];0<this.selects.length&&a.push("$select="+this.selects.join(","));0<this.expands.length&&a.push("$expand="+this.expands.join(","));this.filters&&a.push("$filter="+this.filters);0<this.ordering.length&&a.push("$orderby="+
this.ordering.join(","));null!=this.skipAmount&&a.push("$skip="+this.skipAmount);null!=this.topAmount&&a.push("$top="+this.topAmount);return a.join("&")};return a}();c.RetrieveMultipleRecords=h;h=function(){function a(c,e){this.logicalName=b(c).toString();this.record=e}a.prototype.execute=function(a,b){SDK.REST.createRecord(this.record,this.logicalName,a?a:g,b?b:g)};return a}();c.CreateRecord=h;h=function(){function a(c,e,f){this.logicalName=b(c).toString();this.id=e;this.record=f}a.prototype.execute=
function(a,b){SDK.REST.updateRecord(this.id,this.record,this.logicalName,a?a:g,b?b:g)};return a}();c.UpdateRecord=h;h=function(){function a(c,e){this.logicalName=b(c).toString();this.id=e}a.prototype.execute=function(a,b){SDK.REST.deleteRecord(this.id,this.logicalName,a?a:g,b?b:g)};return a}();c.DeleteRecord=h})(XQC||(XQC={}));
